(function(){!function(){function e(e,t){if(e=String(e),t=String(t),0==e.length)return"";var n=l(u(e)),a=l(u(t).slice(0,16)),s=o(n,a),i=c(s),r=p(i);return r}function t(e,t){if(e=String(e),t=String(t),0==e.length)return"";var n=l(g(e)),a=l(u(t).slice(0,16)),s=d(n,a),i=c(s),r=m(i.replace(/\0+$/,""));return r}function o(e,t){e.length<2&&(e[1]=0);for(var n,a,s=e.length,i=2654435769,r=Math.floor(6+52/s),o=e[s-1],d=e[0],l=0;r-- >0;){l+=i,a=l>>>2&3;for(var c=0;s>c;c++)d=e[(c+1)%s],n=(o>>>5^d<<2)+(d>>>3^o<<4)^(l^d)+(t[3&c^a]^o),o=e[c]+=n}return e}function d(e,t){for(var n,a,s=e.length,i=2654435769,r=Math.floor(6+52/s),o=e[s-1],d=e[0],l=r*i;0!=l;){a=l>>>2&3;for(var c=s-1;c>=0;c--)o=e[c>0?c-1:s-1],n=(o>>>5^d<<2)+(d>>>3^o<<4)^(l^d)+(t[3&c^a]^o),d=e[c]-=n;l-=i}return e}function l(e){for(var t=new Array(Math.ceil(e.length/4)),n=0;n<t.length;n++)t[n]=e.charCodeAt(4*n)+(e.charCodeAt(4*n+1)<<8)+(e.charCodeAt(4*n+2)<<16)+(e.charCodeAt(4*n+3)<<24);return t}function c(e){for(var t="",n=0;n<e.length;n++)t+=String.fromCharCode(255&e[n],e[n]>>>8&255,e[n]>>>16&255,e[n]>>>24&255);return t}function u(e){return unescape(encodeURIComponent(e))}function m(t){try{return decodeURIComponent(escape(t))}catch(e){return t}}function p(e){if("undefined"!=typeof btoa)return btoa(e);if("undefined"!=typeof Buffer)return new Buffer(e,"binary").toString("base64");throw new Error("No Base64 Encode")}function g(e){if("undefined"==typeof atob&&"undefined"==typeof Buffer)throw new Error("No base64 decode");try{if("undefined"!=typeof atob)return atob(e);if("undefined"!=typeof Buffer)return new Buffer(e,"base64").toString("binary")}catch(e){throw new Error("Invalid ciphertext")}}window.BlockTEACrypto={encrypt:e,decrypt:t}}();var c="abc123";var u=window.BlockTEACrypto;var e=10;var t="black";var n="objktiv-session-store";var m=["red","orange","yellow","green","blue","purple","black","white"];var a={nightModeActive:false,itemsPerPage:e,viewerBgColor:t,galleryIndex:0,galleryMap:{}};var s={default:JSON.parse(JSON.stringify(a))};var i=window.localStorage.getItem(n);var p;if(!i){var r=JSON.stringify(s);window.localStorage.setItem(n,JSON.stringify(s));i=JSON.parse(r)}else{i=JSON.parse(i)}var g={wallet:{},isSyncingWallet:true,isLastPage:false,itemsPerPage:e,skipCounts:{hic:0,fxhash:0,objktcom:0},pageSkips:[],session:i.default};var k=JSON.parse(JSON.stringify(g));var o=beacon.DAppClient;var d;C();O();const l=new URLSearchParams(window.location.search);const f=Object.fromEntries(l.entries());if(f.ipfs){x(function(e){if(!e){return false}k.session=i[k.wallet.address]||k.session;C();var t=k.session.viewerBgColor;document.getElementById("selected-bg-color").style.background=t;document.getElementById("viewer-window-content").style.background=t});document.title=f.title;var y=f.title.length>=45?"extra-long-viewer-title":"";document.getElementById("objkt-name").innerHTML='<span id="objkt-name-title" class="'+y+'">'+f.title+'</span><br><span id="objkt-name-artist">'+f.issuer+"</span>";if(f.night){P(f.night==="true")}var h=f.bg||k.session.viewerBgColor;document.getElementById("selected-bg-color").style.background=h;document.getElementById("viewer-window-content").style.background=h;for(let e=0;e<m.length;e++){_(m[e])}document.getElementById("nav").classList.add("hidden");document.getElementById("header").classList.add("hidden");document.getElementById("footer").classList.add("hidden");document.getElementById("footer-push").classList.add("hidden");document.getElementById("viewer-window").classList.remove("hidden");var v=f.ipfs;var b=f.type;var E={image:'<div id="image-resource" style="background-image: url('+v+')"></div>',video:'<video id="video-resource" autoplay loop controls muted><source src="'+v+'"></video>',model:'<model-viewer id="model-resource" src="'+v+'" camera-controls ar ar-modes="webxr scene-viewer quick-look"></model-viewer>'};var w=b.split("/")[0];if(E[w]){document.getElementById("viewer-window-content").innerHTML=E[w]}else{var L=document.createElement("iframe");L.setAttribute("id","interactive-resource");document.getElementById("viewer-window-content").appendChild(L);L.setAttribute("src",v)}var I=function(){document.getElementById("viewer-window-content").style.height=window.innerHeight-document.getElementById("viewer-window-content-nav").offsetHeight+"px"};I();window.addEventListener("resize",I,true);return true}if(f.tz){k.wallet={address:f.tz,anonymous:true};var B;if(f.gallery){B=decodeURIComponent(f.gallery);k.galleryJSON=B=JSON.parse(B)}x(function(e){if(!e||k.wallet.address!==f.tz){k.wallet={address:f.tz,anonymous:true};document.getElementById("header-cta").classList.remove("hidden");document.getElementById("sidebar").classList.add("extended-top");document.getElementById("content").classList.add("anon-view");document.getElementById("sync").classList.add("hidden");document.getElementById("galleries-link").classList.add("hidden");document.getElementById("wallet-lookup-container").classList.add("hidden")}else if(e&&(!!f.gallery||!!f.i_tz)){k.session=i[k.wallet.address]||k.session;C();G()}var t=f.i_tz;$(B,t||null).then(console.log,console.log)})}else{x(function(e){if(!e){return false}k.session=i[k.wallet.address]||k.session;C();G();return $().then(resolve,reject)})}function x(t){p=k.walletClient=new o({name:"OBJKTIV",eventHandlers:{ACTIVE_ACCOUNT_SET:{handler:function(e){console.log("ACTIVE ACCOUNT SET",e);k.isSyncingWallet=false;if(!e||!e.address){return t(false)}k.wallet=e;t(true)}}}});p.subscribeToEvent(beacon.BeaconEvent.PERMISSION_REQUEST_ERROR,()=>{console.log("permissions request aborted");k.isSyncingWallet=false});p.subscribeToEvent(beacon.BeaconEvent.PERMISSION_REQUEST_SENT,()=>{console.log("permissions request aborted");k.isSyncingWallet=false});p.subscribeToEvent(beacon.BeaconEvent.PERMISSION_REQUEST_SUCCESS,()=>{console.log("permissions request aborted");k.isSyncingWallet=false});p.subscribeToEvent(beacon.BeaconEvent.NO_PERMISSIONS,()=>{console.log("permissions request aborted");k.isSyncingWallet=false});p.subscribeToEvent(beacon.BeaconEvent.PERMISSION_REQUEST_SENT,()=>{console.log("permissions request aborted");k.isSyncingWallet=false})}function C(){if(k.session.nightModeActive){document.body.classList.add("night");k.isNightModeActive=k.session.nightModeActive}if(k.session.itemsPerPage){document.getElementById("items-per-page").innerText=k.session.itemsPerPage;k.itemsPerPage=k.session.itemsPerPage}}function S(){var e=["üå¥","üçï","üéôÔ∏è","‚ù§Ô∏è","üî•","üîà","üìª","üéµ","üé∂"];return e[Math.floor(Math.random()*e.length)]}function _(s){const e=document.getElementById("bg-color-picker-menu");const t=document.createElement("div");t.style.background=s;t.classList.add("color-option");t.setAttribute("data-color",s);t.addEventListener("click",function(){k.session.viewerBgColor=s;Z();document.getElementById("viewer-window-content").style.background=s;document.getElementById("selected-bg-color").style.background=s;var e=window.location.href.split("?");var t=e[1];var n=null;if(t){t=new URLSearchParams(t);t.delete("bg");var a=s;if(m.indexOf(a)===-1){a="#"+a}n=e[0]+"?"+t.toString()+"&bg="+encodeURIComponent(a);window.history.pushState({},document.title,n)}A()});e.appendChild(t)}function A(){k.viewerColorMenuOpen=false;document.getElementById("bg-color-picker-menu").classList.add("hidden");document.getElementById("hex-color-picker-container").classList.add("hidden")}function j(){document.getElementById("pop-up-container").classList.add("hidden");document.getElementById("gallery-link-content").classList.add("hidden");document.getElementById("settings-content-container").classList.add("hidden")}function T(){document.getElementById("sidebar-container").classList.add("hidden")}function O(){document.getElementById("main-menu-link").addEventListener("click",function(){Y()});document.addEventListener("keydown",function(e){if(e.code&&e.code==="Escape"||e.keyCode&&e.keyCode===27){T();j()}});var e=document.getElementsByClassName("sidebar-link");for(var t=0;t<e.length;t++){e[t].addEventListener("click",function(){T()},false)}document.getElementById("sidebar-container").addEventListener("click",T);document.getElementById("sidebar-toggle").addEventListener("click",function(e){var t=document.getElementById("sidebar-container");var n=Array.prototype.slice.call(t.classList);if(n.indexOf("hidden")===-1){t.classList.add("hidden")}else{t.classList.remove("hidden")}});document.getElementById("title").addEventListener("click",function(){window.location.href=window.location.href.split("#")[0].split("?")[0]});document.getElementById("galleries-link").addEventListener("click",function(e){W();e.preventDefault()});document.getElementById("settings-link").addEventListener("click",function(e){X();e.preventDefault()});document.getElementById("settings-import-submit").addEventListener("click",function(e){if(Array.prototype.slice.call(e.target.classList).indexOf("disabled")!==-1){return false}var t=document.getElementById("settings-import-input").innerText;var n;document.getElementById("settings-import-input").innerText="";try{n=u.decrypt(t,c);n=JSON.parse(n);if(typeof n!=="object"||Array.isArray(n)){throw"Settings not an object"}}catch(e){console.log("Settings import input not valid settings",e);n=null}if(n){k.session=n;Z();C()}});document.getElementById("settings-export-submit").addEventListener("click",function(){document.getElementById("settings-export-text").focus();e(document.getElementById("settings-export-text").innerText);function e(e){if(navigator.clipboard){navigator.clipboard.writeText(e).then(()=>{alert("Settings copied to clipboard")},e=>{alert("Failed to copy settings - Copy settings manually")})}else if(window.clipboardData){window.clipboardData.setData("Text",e)}}});document.getElementById("pop-up-exit").addEventListener("click",j);document.getElementById("pop-up-exit-overlay").addEventListener("click",j);var n=function(e){var t=document.getElementById("new-gallery-input").textContent;if(t){document.getElementById("new-gallery-input").textContent="";k.session.galleryMap[k.session.galleryIndex]={displayName:t,hic:[],fxhash:[],objktcom:[]};k.session.galleryIndex+=1;Z();Y()}e.stopPropagation();e.preventDefault()};document.getElementById("new-gallery-input").addEventListener("keypress",function(e){if(e.code&&e.code==="Enter"||e.keyCode&&e.keyCode===13){e.preventDefault();n()}});document.getElementById("new-gallery-submit").addEventListener("click",n);document.getElementById("selected-bg-color").addEventListener("click",function(e){if(!k.viewerColorMenuOpen){N();k.viewerColorMenuOpen=true}else{A()}e.stopPropagation()});var a=function(){let e=document.getElementById("hex-color-picker").textContent;e=e.replace("#","");if(e.length===3||e.length===6){document.getElementById("selected-bg-color").style.background="#"+e;document.getElementById("viewer-window-content").style.background="#"+e;k.session.viewerBgColor="#"+e;Z();_("#"+e);var t=window.location.href.split("?");var n=t[1];var a=null;if(n){n=new URLSearchParams(n);n.delete("bg");var s=e;if(m.indexOf(s)===-1){s="#"+s}a=t[0]+"?"+n.toString()+"&bg="+encodeURIComponent(s);window.history.pushState({},document.title,a)}}A()};document.getElementById("hex-color-picker").addEventListener("keypress",function(e){if(e.code&&e.code==="Enter"||e.keyCode&&e.keyCode===13){e.preventDefault();a()}});document.getElementById("hex-color-picker").addEventListener("click",function(){document.getElementById("hex-color-picker").innerHTML=""});document.getElementById("hex-color-picker-submit").addEventListener("click",a);document.getElementById("settings-import-input").addEventListener("input",function(){const e=document.getElementById("settings-import-input").innerText;document.getElementById("settings-import-input").innerHTML="";document.getElementById("settings-import-input").innerText="";document.getElementById("settings-import-input").innerText=e.replace("\n","");var t=document.getElementById("settings-import-submit");console.log(e);if(e){t.classList.remove("disabled")}else{t.classList.add("disabled")}},false);document.getElementById("wallet-lookup-input").addEventListener("input",function(){const e=document.getElementById("wallet-lookup-input").innerText;document.getElementById("wallet-lookup-input").innerHTML="";document.getElementById("wallet-lookup-input").innerText="";document.getElementById("wallet-lookup-input").innerText=e.replace("\n","")},false);var s=function(){var e=document.getElementById("wallet-lookup-input").textContent;if(e){window.location.href=window.location.href.split("?")[0].replace("#","")+"?tz="+e}};document.getElementById("wallet-lookup-input").addEventListener("keypress",function(e){if(e.code&&e.code==="Enter"||e.keyCode&&e.keyCode===13){e.preventDefault();s()}});document.getElementById("wallet-lookup-submit").addEventListener("click",s);document.getElementById("exit-anon").addEventListener("click",function(e){e.preventDefault();window.location.href=window.location.href.split("?")[0]});var i=function(e){if((document.body.getAttribute("class")||"").indexOf("night")===-1){P(true)}else{P(false)}e.preventDefault();return false};document.getElementById("day-night-toggle").addEventListener("click",i);document.getElementById("sync").addEventListener("click",function(e){if(!k.wallet.address&&!k.isSyncingWallet){k.walletClient.requestPermissions().then(function(){return k.walletClient.getAccounts()}).then(function(e){k.wallet=e[0];k.isSyncingWallet=false}).catch(console.log)}else if(k.wallet.address&&!k.isSyncingWallet){k.isSyncingWallet=true;k.walletClient.removeAllAccounts().then(function(){k.wallet={};Q();document.getElementById("main-content").innerHTML="";k=JSON.parse(JSON.stringify(g));k.isSyncingWallet=false;k.walletClient=p;V()}).catch(console.log)}});document.getElementById("increase-items-per-page").addEventListener("click",function(e){D(1)});document.getElementById("decrease-items-per-page").addEventListener("click",function(e){D(0)});var r=new URLSearchParams(window.location.search);var o=Object.fromEntries(r.entries());var d=function(e){if(Array.prototype.slice.call(e.target.classList,0).indexOf("disabled")!==-1){e.stopPropagation();e.preventDefault();return false}document.getElementById("next-page-controls").classList.add("hidden");$(k.galleryJSON,o.i_tz)};document.getElementById("next-page").addEventListener("click",d);document.getElementById("next-page-mobile").addEventListener("click",d);var l=function(e){if(Array.prototype.slice.call(e.target.classList,0).indexOf("disabled")!==-1){e.stopPropagation();e.preventDefault();return false}if(k.pageSkips.length){k.skipCounts=k.pageSkips.splice(k.pageSkips.length-2,2)[0]}else{z()}document.getElementById("next-page-controls").classList.add("hidden");$(k.galleryJSON,o.i_tz)};document.getElementById("previous-page").addEventListener("click",l);document.getElementById("previous-page-mobile").addEventListener("click",l)}function P(e){if(e){document.body.classList.add("night");k.session.nightModeActive=true}else{document.body.classList.remove("night");k.session.nightModeActive=false}Z()}function N(){document.getElementById("bg-color-picker-menu").classList.remove("hidden");document.getElementById("hex-color-picker-container").classList.remove("hidden")}function U(a){const e=document.createElement("div");e.classList.add("objkt-container");const t=document.createElement("div");var n=function(){var e=k.session.viewerBgColor;var t=window.location.href.split("?")[0].replace("#","")+"?ipfs="+encodeURIComponent(a.gatewayUri)+"&type="+encodeURIComponent(a.type)+"&title="+encodeURIComponent(a.name)+"&issuer="+encodeURIComponent(a.issuer.handle)+"&night="+encodeURIComponent(k.session.nightModeActive)+"&bg="+encodeURIComponent(e);var n="directories=no,titlebar=no,toolbar=no,location=no,status=no,menubar=no,scrollbars=no";window.open(t,Date.now().toString(),n)};t.classList.add("preview");t.addEventListener("click",n);const s=document.createElement("div");s.classList.add("objkt-metadata");const i=document.createElement("a");i.classList.add("artist");i.setAttribute("href",window.location.href.split("?")[0].replace("#","")+"?tz="+k.wallet.address+"&i_tz="+a.issuer.address);i.innerText=a.issuer.handle;const r=document.createElement("a");r.classList.add("title");r.setAttribute("href","#");r.addEventListener("click",function(e){e.preventDefault();n()});r.setAttribute("target","blank");r.innerText=a.name;if(a.name&&a.name.length>45){r.classList.add("extra-long-title")}const o=document.createElement("a");o.classList.add("ipfs-link");o.setAttribute("href",a.ipfsLink);o.setAttribute("target","blank");o.innerText=a.ipfsLink.substr(0,20)+"...";const d=document.createElement("a");d.classList.add("gateway-link");d.setAttribute("href",a.gatewayUri);d.setAttribute("target","blank");d.innerText=a.gatewayUri.substr(0,30)+"...";var l=document.createElement("div");l.innerText="üñºÔ∏è";l.classList.add("objkt-gallery-settings");l.addEventListener("click",function(){W(a)});var c=document.createElement("img");c.classList.add("preview-img");c.setAttribute("src",a.displayImgUri);s.appendChild(r);s.appendChild(document.createElement("br"));s.appendChild(i);var u=document.createElement("div");u.classList.add("objkt-settings-menu-container");var m=document.createElement("a");m.setAttribute("href","#");m.classList.add("objkt-settings-link");m.innerText="gallery settings";m.addEventListener("click",function(e){e.preventDefault();W(a)});if(!k.wallet.anonymous){u.appendChild(m)}var p=document.createElement("a");p.setAttribute("href",a.platformUri);p.setAttribute("target","_blank");p.classList.add("objkt-settings-link");p.innerText="view original";u.appendChild(p);u.classList.add("hidden");if(a.objktComLink){var g=document.createElement("a");g.setAttribute("href",a.objktComLink);g.setAttribute("target","_blank");g.classList.add("objkt-settings-link");g.innerText="view objkt.com";u.appendChild(g)}s.appendChild(u);t.appendChild(c);var f=document.createElement("div");f.classList.add("objkt-settings-toggle");f.innerHTML='<div class="objkt-settings-toggle-icon"></div>'+'<div class="objkt-settings-toggle-icon"></div>'+'<div class="objkt-settings-toggle-icon"></div>';s.appendChild(f);m.addEventListener("click",function(){u.classList.add("hidden")});p.addEventListener("click",function(){u.classList.add("hidden")});g.addEventListener("click",function(){u.classList.add("hidden")});f.addEventListener("click",function(){if(Array.prototype.slice.call(u.classList).indexOf("hidden")===-1){u.classList.add("hidden")}else{u.classList.remove("hidden")}});e.appendChild(t);var y=document.createElement("div");y.classList.add("preview-push");t.appendChild(y);e.appendChild(s);var h=document.createElement("div");h.classList.add("objkt-outer-wrapper");var v=document.createElement("div");v.classList.add("objkt-wrapper-table");var b=document.createElement("div");b.classList.add("objkt-wrapper-table-cell");b.appendChild(e);v.appendChild(b);h.appendChild(v);h.classList.add("placeholder-aspect");c.onload=function(){h.classList.remove("placeholder-aspect");console.log(c.naturalHeight,c.naturalWidth);if(c.naturalHeight===c.naturalWidth){t.classList.add("square-aspect");e.classList.add("square-aspect");h.classList.add("square-aspect")}else if(c.naturalHeight<c.naturalWidth){if(c.naturalWidth-(c.naturalWidth-c.naturalHeight)>=c.naturalWidth*.9){t.classList.add("square-aspect");e.classList.add("square-aspect");h.classList.add("square-aspect")}else{t.classList.add("landscape-aspect");e.classList.add("landscape-aspect");h.classList.add("landscape-aspect")}}else{t.classList.add("portrait-aspect");e.classList.add("portrait-aspect");h.classList.add("portrait-aspect")}};return h}function M(e,t,n,a){var s=t&&t.hic;var i="";var r=true;var o="token: {creator: {address: {_neq: $address}}}";if(a){o='token: {creator: {address: {_eq: "'+a+'"}}}'}else if(Array.isArray(s)&&s.length){i=", _or: [";for(let e=0;e<s.length;e++){i+="{token_id: {_eq: "+s[e]+"}}";if(e<s.length-1){i+=","}}i+="]"}else if(Array.isArray(s)){r=false}return!r?Promise.resolve(null):fetch("https://hdapi.teztools.io/v1/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"\nquery collectorGallery($address: String!) {\n  hic_et_nunc_token_holder(limit: "+n+", offset: "+k.skipCounts.hic+", where: {holder_id: {_eq: $address}, "+o+', quantity: {_gt: "0"} '+i+"}, order_by: {token_id: desc}) {\n    token {\n      id\n      artifact_uri\n      display_uri\n      thumbnail_uri\n      timestamp\n      mime\n      title\n      description\n      supply\n      royalties\n      creator {\n        address\n        name\n      }\n    }\n  }\n}\n",variables:{address:e},operationName:"collectorGallery"})})}function q(t,e,n,a){var s=e&&e.fxhash;var i="(take: "+n+", skip: "+k.skipCounts.fxhash+")";var r=true;var o="";var d={id:t};if(a){o=", $filters: ObjktFilter";i="(filters: $filters, take: "+n+", skip: "+k.skipCounts.fxhash+")";d.filters={author_in:[a]}}else if(Array.isArray(s)&&s.length){return Promise.all(s.map(e=>fetch("https://api.fxhash.xyz/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({operationName:"Query",variables:{objktId:e},query:"query Query($objktId: Float) {\nobjkt(id: $objktId) {\n      id\n      assigned\n      iteration\n      owner {\n        id\n        name\n        flag\n        avatarUri\n        __typename\n      }\n      issuer {\n        name\n        flag\n        author {\n          id\n          name\n          flag\n          avatarUri\n          __typename\n        }\n        __typename\n      }\n      name\n      metadata\n      createdAt\n      offer {\n        id\n        price\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n"})}))).then(e=>Promise.all(e.map(e=>e?e.json():e))).then(e=>{e=e.filter(e=>{return e&&e.data&&e.data.objkt&&e.data.objkt.owner&&e.data.objkt.owner.id===t});return!e.length?null:e.reduce((e,t)=>{e.data.user.objkts.push(t.data.objkt);return e},{data:{user:{objkts:[]}}})})}else if(Array.isArray(s)){r=false}return!r?Promise.resolve(null):fetch("https://api.fxhash.xyz/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({operationName:"Query",variables:d,query:"query Query($id: String!"+o+") {\n  user(id: $id) {\n    id\n    objkts"+i+" {\n      id\n      assigned\n      iteration\n      owner {\n        id\n        name\n        flag\n        avatarUri\n        __typename\n      }\n      issuer {\n        name\n        flag\n        author {\n          id\n          name\n          flag\n          avatarUri\n          __typename\n        }\n        __typename\n      }\n      name\n      metadata\n      createdAt\n      offer {\n        id\n        price\n        __typename\n      }\n      __typename\n    }\n    __typename\n  }\n}\n"})})}function H(e,t,n,a){var s=t&&t.objktcom;var i="limit: "+n+", offset: "+k.skipCounts.objktcom+",";var r=true;var o="";var d="";if(a){d='{token: {fa2: {creator: {address: {_eq: "'+a+'"}}}}},'}else if(Array.isArray(s)&&s.length){var l=s.map(e=>{var t=e.split("|");return'{token: {id: {_eq: "'+t[0]+'"}, fa2: {contract: {_eq: "'+t[1]+'"}}}}'});o="{_or: ["+l.join(",")+"]},"}else if(Array.isArray(s)){r=false}return!r?Promise.resolve(null):fetch("https://data.objkt.com/v1/graphql",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({query:"query GetObjktComTokens {token(order_by: {timestamp: desc},"+i+' where: {token_holders: {quantity: {_gt: 0}, holder: {address: {_eq: "'+e+'"}}, _and: ['+d+""+o+'{token: {fa2: {contract: {_neq: "KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton"}}}}, {token: {fa2: {contract: {_neq: "KT1KEa8z6vWXDJrVqtMrAeDVzsvxat3kHaCE"}}}}]}}) {id,fa2 {name,contract,collection_id},timestamp,title,creator {tzdomain,address,alias},mime,description,display_uri,artifact_uri,thumbnail_uri}}'})})}function J(e,a,t){var n=Math.floor(k.itemsPerPage*1.5);var s=[];s.push(M(e,a,n,t));s.push(q(e,a,n,t));s.push(H(e,a,n,t));return Promise.all(s).then(([e,t,n])=>{var a=[];a.push(e&&e.text?e.text():e);a.push(t&&t.text?t.text():t);a.push(n&&n.text?n.text():n);return Promise.all(a)}).then(([e,t,n])=>{e=typeof e==="string"?JSON.parse(e):e;t=typeof t==="string"?JSON.parse(t):t;n=typeof n==="string"?JSON.parse(n):n;console.log("hasddas",t);if(a&&a.fxhash&&a.fxhash.length&&t&&t.data&&t.data.user&&t.data.user.objkts){t.data.user.objkts=t.data.user.objkts.filter(function(e){var t=a&&a.fxhash;return t.indexOf(e.id)!==-1});if(t.data.user.objkts.length<=k.skipCounts.fxhash){t.data.user.objkts=[]}else{t.data.user.objkts.splice(0,k.skipCounts.fxhash);if(t.data.user.objkts.length>k.itemsPerPage){k.skipCounts.fxhash=k.skipCounts.fxhash.slice(0,k.itemsPerPage)}}}return{hic:!e||!e.data||!e.data.hic_et_nunc_token_holder?[]:e.data.hic_et_nunc_token_holder.map(e=>{var t;var n;var a=e.token.mime.split("/")[0];if(a==="image"||a==="model"){n="https://cloudflare-ipfs.com/ipfs/"}else{n="https://gateway.pinata.cloud/ipfs/"}t=a==="image"&&"image"||a==="video"&&"video"||a==="model"&&"model"||"web";return{count:e.token.supply,createdAt:e.token.timestamp,description:e.token.description,displayImgIpfsHash:e.token.display_uri.substr(7),displayImgUri:"https://cloudflare-ipfs.com/ipfs/"+e.token.display_uri.substr(7),gatewayUri:n+e.token.artifact_uri.substr(7),identifier:e.token.id,ipfsLink:e.token.artifact_uri,name:e.token.title,issuer:{address:e.token.creator.address,avatarIpfsHash:null,handle:e.token.creator.name||R(e.token.creator.address),platform:"HIC"},objktComLink:"https://objkt.com/asset/hicetnunc/"+e.token.id,platformUri:"https://hicetnunc.art/objkt/"+e.token.id,platformIssuerUri:"https://objkt.com/profile/"+e.token.creator.address+"/created/?fa2=KT1RJ6PbjHpwc3M5rw5s2Nbmefwbuwbdxton",resourceIpfsHash:e.token.artifact_uri.substr(7),type:t}}),fxhash:!t||!t.data||!t.data.user||!t.data.user.objkts?[]:t.data.user.objkts.map(e=>({count:1,createdAt:e.createdAt,description:e.metadata.description,displayImgIpfsHash:e.metadata.displayUri.substr(7),displayImgUri:"https://cloudflare-ipfs.com/ipfs/"+e.metadata.displayUri.substr(7),gatewayUri:"https://gateway.fxhash.xyz/ipfs/"+e.metadata.artifactUri.substr(7),identifier:e.id,ipfsLink:e.metadata.displayUri,issuer:{address:e.issuer.author.id,avatarIpfsHash:e.issuer.author.avatarUri.substr(7),handle:e.issuer.author.name||R(e.issuer.author.id),platform:"FXHASH"},name:e.name,objktComLink:"https://objkt.com/asset/fxhashgenesis/"+e.id,platformUri:"https://www.fxhash.xyz/gentk/"+e.id,platformIssuerUri:"https://www.fxhash.xyz/pkh/"+e.issuer.author.id,resourceIpfsHash:e.metadata.artifactUri.substr(7),type:"web"})),objktcom:!n||!n.data||!n.data.token?[]:n.data.token.map(e=>{var t=e.mime.split("/")[0];if(t==="image"||t==="model"){ipfsGatewayHost="https://cloudflare-ipfs.com/ipfs/"}else{ipfsGatewayHost="https://gateway.pinata.cloud/ipfs/"}tokenType=t==="image"&&"image"||t==="video"&&"video"||t==="model"&&"model"||"web";return{count:null,createdAt:e.timestamp,description:e.description,displayImgIpfsHash:e.display_uri.substr(7),displayImgUri:"https://cloudflare-ipfs.com/ipfs/"+e.display_uri.substr(7),gatewayUri:ipfsGatewayHost+e.artifact_uri.substr(7),identifier:e.id+"|"+e.fa2.contract,ipfsLink:e.artifact_uri,issuer:{address:e.creator.address,avatarIpfsHash:null,handle:e.creator.alias||e.fa2.name||R(e.creator.address),platform:"OBJKTCOM"},name:e.title,objktComLink:"https://objkt.com/asset/"+e.fa2.contract+"/"+e.id,platformUri:"https://objkt.com/asset/"+e.fa2.contract+"/"+e.id,platformIssuerUri:"https://objkt.com/profile/"+e.creator.address+"/created",resourceIpfsHash:e.artifact_uri.substr(7),type:tokenType}})}}).then(e=>{return Object.values(e).reduce((e,t)=>e.concat(t),[]).sort(function(e,t){return new Date(t.createdAt).getTime()-new Date(e.createdAt).getTime()})}).then(e=>{if(!e.length){return false}if(e.length<=k.itemsPerPage){k.isLastPage=true}else{k.isLastPage=false}var t=e.slice(0,k.itemsPerPage);k.pageSkips.push(JSON.parse(JSON.stringify(k.skipCounts)));console.log("unincreased skip counts",k.skipCounts);for(let e=0;e<t.length;e++){var n=t[e];var a=n.issuer.platform.toLowerCase();k.skipCounts[a]+=1}console.log("increased skip counts",k.skipCounts);return t}).catch(console.log)}function R(e){return e.substr(0,5)+"..."+e.substr(e.substr.length-5,e.substr.length)}function D(e){const t=[10,25,50,100];const n=t.indexOf(k.itemsPerPage);const a=e&&n!==t.length-1;const s=!e&&n!==0;let i;if(a){i=t[n+1]}else if(s){i=t[n-1]}if(i){k.session.itemsPerPage=i;Z();z();k.itemsPerPage=i;k.pageSkips=[];document.getElementById("items-per-page").innerText=i;const e=new URLSearchParams(window.location.search);const t=Object.fromEntries(e.entries());$(k.galleryJSON,t.i_tz)}}function z(){var t=Object.keys(k.skipCounts);for(let e=0;e<t.length;e++){k.skipCounts[t[e]]=0}}function W(e){document.getElementById("pop-up-container").classList.remove("hidden");Y(e)}function $(e,t){const n=document.getElementById("main-content");n.innerHTML="";return J(k.wallet.address,e,t).then(t=>{n.innerHTML="";if(!t){return false}for(let e=0;e<t.length;e++){n.appendChild(U(t[e]))}K();if(k.isLastPage){document.getElementById("next-page").classList.add("disabled");document.getElementById("next-page-mobile").classList.add("disabled")}else{document.getElementById("next-page").classList.remove("disabled");document.getElementById("next-page-mobile").classList.remove("disabled")}if(k.pageSkips.length===1){document.getElementById("previous-page").classList.add("disabled");document.getElementById("previous-page-mobile").classList.add("disabled")}else{document.getElementById("previous-page").classList.remove("disabled");document.getElementById("previous-page-mobile").classList.remove("disabled")}}).then(console.log,console.log)}function G(){document.getElementById("sync").innerText="unsync";document.getElementById("wallet-nav").classList.remove("hidden")}function Q(){document.getElementById("sync").innerText="sync";document.getElementById("wallet-nav").classList.add("hidden")}function K(){document.getElementById("next-page-controls").classList.remove("hidden");document.getElementById("page-control-nav").classList.remove("hidden")}function V(){document.getElementById("next-page-controls").classList.add("hidden");document.getElementById("page-control-nav").classList.add("hidden")}function F(e){document.getElementById("pop-up-header-content").innerText=e}function X(){document.getElementById("pop-up-container").classList.remove("hidden");var e=document.getElementById("settings-content-container");console.log("session",k.session);document.getElementById("settings-export-text").innerText=u.encrypt(JSON.stringify(k.session),c);F("Your Settings");e.classList.remove("hidden")}function Y(n){if(n){F("Gallery Membership");document.getElementById("new-gallery-input").classList.add("hidden");document.getElementById("new-gallery-submit").classList.add("hidden");document.getElementById("no-gallery-message-container").classList.remove("hidden")}else{F("Manage Galleries");document.getElementById("new-gallery-input").classList.remove("hidden");document.getElementById("new-gallery-submit").classList.remove("hidden");document.getElementById("no-gallery-message-container").classList.add("hidden")}var e=document.getElementById("gallery-link-container");document.getElementById("gallery-link-content").classList.remove("hidden");e.innerHTML="";var a=Object.keys(k.session.galleryMap);console.log(k.session.galleryMap);a=a.sort(function(e,t){return k.session.galleryMap[e].displayName.charCodeAt(0)-k.session.galleryMap[t].displayName.charCodeAt(0)});if(!a.length&&!!n){document.getElementById("no-gallery-message-container").classList.remove("hidden")}else{document.getElementById("no-gallery-message-container").classList.add("hidden")}for(let t=0;t<a.length;t++){var s=k.session.galleryMap[a[t]];var i=document.createElement("div");i.classList.add("gallery-link-wrapper");var r="gallery-link-"+a[t];i.setAttribute("id",r);var o=document.createElement("a");o.classList.add("remove-gallery");o.setAttribute("href","#");o.setAttribute("data-gallery-key",a[t]);o.innerText="[DEL]";o.addEventListener("click",function(){delete k.session.galleryMap[a[t]];Z();Y()});var d=document.createElement("a");d.classList.add("gallery-link");d.setAttribute("href","#");d.setAttribute("data-gallery-key",a[t]);d.innerText=s.displayName;d.addEventListener("click",function(){window.location.href=window.location.href.split("#")[0].split("?")[0]+"?tz="+k.wallet.address+"&gallery="+encodeURIComponent(JSON.stringify(k.session.galleryMap[a[t]]))});if(!n){i.appendChild(o)}else{var l=k.session.galleryMap[a[t]];var c=n.issuer.platform.toLowerCase();l[c]=l[c]||[];var u=l[c].indexOf(n.identifier);if(u!==-1){var m=document.createElement("a");m.classList.add("remove-from-gallery");m.setAttribute("href","#");m.setAttribute("data-gallery-key",a[t]);m.innerText="[RMV]";m.addEventListener("click",function(e){k.session.galleryMap[a[t]][c].splice(u,1);Z();Y(n);e.preventDefault()});i.appendChild(m)}else{var p=document.createElement("a");p.classList.add("add-to-gallery");p.setAttribute("href","#");p.setAttribute("data-gallery-key",a[t]);p.innerText="[ADD]";p.addEventListener("click",function(e){k.session.galleryMap[a[t]][c].push(n.identifier);Z();Y(n);e.preventDefault()});i.appendChild(p)}}i.appendChild(d);e.appendChild(i)}}function Z(){i[k.wallet.address||"default"]=k.session;console.log("storing session",i);window.localStorage.setItem(n,JSON.stringify(i))}})();